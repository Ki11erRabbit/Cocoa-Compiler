module Shared where

skipParser :: Parser ()
skipParser = space 

myinteger :: Parser String
myinteger = do
  trace "myinteger" $ return ()
  out <- takeWhile1P (Just "integer") (\c -> c >= '0' && c <= '9')
  trace ("myinteger: " ++ show out) $ return ()
  _ <- skipParser
  return (unpack out)

myfloat :: Parser String
myfloat = try $ do
  whole <- takeWhile1P (Just "whole") (\c -> c >= '0' && c <= '9')
  _ <- char '.'
  decimal <- takeWhile1P (Just "decimal") (\c -> c >= '0' && c <= '9')
  return $ (unpack whole) ++ "." ++ (unpack decimal)

mychar :: Parser Char
mychar = between (char '\'') (char '\'') anyChar

mystring :: Parser String
mystring = do
  char '"'
  str <- manyTill anyChar (char '"')
  return str

mybool :: Parser Bool
mybool = do
  bool <- try (string "true") <|> string "false"
  return $ bool == "true"

anyChar :: Parser Char
anyChar = satisfy (const True)
